
    _taskmarksDataFilePath
    _activePathChar
    _inactivePathChar

@startuml startup

hide footbox

mainframe **toggle taskmark**

actor VSCode
participant Helper as help
participant Task as task
participant PathHelper as ph
participant File as file
participant Persist as p

VSCode -> help: toggleMark
activate help #FFBBBB

note right of help
    all actions on
    _taskManager.
    activeTask
end note


help -> VSCode: get activeTextEditor
activate help #DarkSalmon
activate VSCode #DarkSalmon
VSCode -> help: with (document.fileName, selection.active.line)
deactivate VSCode
deactivate help


help -> task: toggle (fileName, activeLine)
activate task #SkyBlue
note right of task
    has
    _name: string
    _files: Ring<File>
    _activeFile: File
end note



task -> ph: reducePath(filename)
activate task #LightGoldenRodYellow
activate ph #LightGoldenRodYellow

note right of ph
    PathHelper knows
    _basePath
end note

ph -> task: reducedPath
deactivate ph
deactivate task

task -> task: does file exist

alt file exists
    task -> file: toggleTaskMark(lineNumber)
    file -> file: does lineNumber exist
    alt lineNumber exists
        file -> file: remove lineNumber from _marks
    else lineNumber not found
        file -> file: addMark(lineNumber)
        activate file #DarkSalmon
        file -> file: mergeMarksAndLineNumbers([lineNumber])

        
        deactivate file
    end

else file not found
    task -> file: new File(reducedFilePath, lineNumber)
    task -> task: add file to files

end


task -> help: file.hasMarks()
deactivate task

deactivate help






Alice -> Bob: Authentication Request

alt successful case

    Bob -> Alice: Authentication Accepted

else some kind of failure

    Bob -> Alice: Authentication Failure
    group My own label
    Alice -> Log : Log attack start
        loop 1000 times
            Alice -> Bob: DNS Attack
        end
    Alice -> Log : Log attack end
    end

else Another type of failure

   Bob -> Alice: Please repeat

end









@endjson




